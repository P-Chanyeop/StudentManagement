# 🔍 미개발 기능 체크리스트

> **작성일**: 2025-12-17
> **프로젝트**: 학원 출석·수업관리·문자 발송 통합 시스템
> **현재 구현률**: 약 92%

---

## ✅ 이미 완료된 핵심 기능 (참고용)

### 1️⃣ 학생 / 수업 데이터 구조
- ✅ Student 엔티티 (이름, 연락처, 학년, 성별, 학교, 생년월일, 주소, 보호자 연락처, 메모)
- ✅ Enrollment 엔티티 (PERIOD 기간제 + COUNT 횟수제 지원)
- ✅ 공휴일 API 연동 (수강권 기간 계산 시 공휴일 자동 제외)
- ✅ 출석부 테이블 (비고, 학생이름, 수업시간, 등원시간, 하원시간, 체크박스)
- ✅ 출석부 정렬 기능 (**등원순 정렬**, **하원순 정렬**)

### 2️⃣ 예약 시스템
- ✅ Reservation 엔티티 (예약 생성, 취소, 강제 취소)
- ✅ 예약 취소 제한 규칙 (전날 오후 6시까지만 취소 가능)
- ✅ 예약 취소 시 수강권 횟수 자동 복구
- ✅ 예약 출처 구분 (WEB, NAVER, PHONE)

### 3️⃣ 출석 관리
- ✅ Attendance 엔티티 (등원, 하원, 예상 하원 시간)
- ✅ 하원 예상 시간 자동 계산 (등원시간 + 수업시간)
- ✅ 출석 상태 (출석, 지각, 결석, 사유결석, 조퇴)
- ✅ 자동 지각 판정 (10분 이상 지각 시)

### 4️⃣ 문자 발송 시스템
- ✅ 수동 문자 발송 (Messages.jsx 페이지, 학생 선택 + 메시지 작성)
- ✅ 자동 문자 발송 4가지 시나리오:
  - 지각 알림 (10분 이상 지각 시 즉시 발송)
  - 수강권 만료 예정 알림 (4주 이내, 매일 오전 9시)
  - 만료 수강권 재등록 안내 (매주 월요일 오전 9시)
  - 레벨테스트 리마인더 (다음날 테스트, 매일 오후 5시)

### 5️⃣ 상담 관리
- ✅ Consultation 엔티티 (상담 날짜, 제목, 내용, 상담 유형)
- ✅ 녹음 파일 URL 저장 (`recordingFileUrl` 필드)
- ✅ 첨부 파일 URL 저장 (`attachmentFileUrl` 필드)
- ✅ 후속 조치 사항 추적
- ✅ 다음 상담일 설정

### 6️⃣ 레벨테스트 & 공지사항
- ✅ LevelTest 엔티티 (캘린더/일정 관리 시스템)
- ✅ Notice 엔티티 (CRUD + 상단 고정 + 검색 + 페이징)

### 7️⃣ 권한 관리
- ✅ UserRole 4가지 (ADMIN, TEACHER, PARENT, STUDENT)
- ✅ 세밀한 권한 제어 (각 API마다 @PreAuthorize)
- ✅ JWT 인증 (Access Token + Refresh Token)

---

## ❌ 아직 개발되지 않은 기능

### 🔴 **1. 마이페이지 (학생/보호자용 전용 UI)**

**현황**: API 레벨에서는 권한 제어 완료, 하지만 전용 UI 페이지 없음

**필요한 작업**:
- [ ] **학생용 마이페이지** (`/frontend/src/pages/StudentMyPage.jsx`)
  - [ ] 본인의 수강권 정보 조회 (잔여 횟수, 만료 기한)
  - [ ] 본인의 출석 현황 조회
  - [ ] 본인의 예약 현황 조회
  - [ ] 본인의 레벨테스트 일정 조회

- [ ] **학부모용 마이페이지** (`/frontend/src/pages/ParentMyPage.jsx`)
  - [ ] 자녀의 수강권 정보 조회
  - [ ] 자녀의 출석 현황 조회
  - [ ] 자녀의 예약 현황 조회
  - [ ] 자녀의 상담 기록 조회
  - [ ] 자녀의 레벨테스트 일정 조회
  - [ ] 받은 문자 메시지 내역 조회

**예상 작업량**: 중간 (API는 이미 구현되어 있으므로, 프론트엔드 UI만 개발)

**체크리스트 항목**:
- 체크리스트 6번: "학생의 수업 잔여 횟수, 기한을 보여주는 기능 => 마이페이지"
- 체크리스트 3번: "학생은 마이페이지에서 본인의 출석체크 현황, 수업 신청 현황만 볼 수 있음"

---

### 🔴 **2. 파일 실제 업로드 API (녹음 파일, 첨부 파일)**

**현황**: Consultation 엔티티에 `recordingFileUrl`, `attachmentFileUrl` 필드는 있으나, 파일을 실제로 업로드하는 API 없음

**필요한 작업**:
- [ ] **파일 업로드 Controller** (`FileUploadController.java`)
  - [ ] `POST /api/files/upload` - 파일 업로드 API
  - [ ] 파일 크기 제한 (녹음 파일: 50MB, 첨부 파일: 10MB)
  - [ ] 허용 파일 형식 검증 (녹음: mp3, m4a, wav / 첨부: pdf, jpg, png)
  - [ ] 파일명 중복 방지 (UUID 추가)

- [ ] **파일 스토리지 선택 및 설정**
  - 옵션 1: 로컬 스토리지 (`/uploads` 디렉토리)
  - 옵션 2: AWS S3 연동 (권장, 별도 AWS 계정 필요)
  - 옵션 3: Cloudinary 같은 CDN 서비스

- [ ] **Consultation 서비스 수정**
  - [ ] `addRecordingFile()` 메서드에 실제 파일 업로드 연동
  - [ ] 파일 삭제 기능 (상담 삭제 시 파일도 같이 삭제)

- [ ] **프론트엔드 파일 선택 UI**
  - [ ] Consultations.jsx에 파일 선택 input 추가
  - [ ] 업로드 진행률 표시
  - [ ] 업로드된 파일 미리보기 및 재생 (녹음 파일의 경우)

**예상 작업량**: 중간~높음 (스토리지 연동에 따라 다름)

**체크리스트 항목**:
- 체크리스트 5번: "수업 녹음을 할 수 있는데 그거를 업로드 해두고 싶음. (녹음파일, 수업 내용, 학생 지정이 가능했으면 좋겠음)"

---

### 🔴 **3. 보강 수업 관리 시스템**

**현황**: 완전 미구현 (예약 취소 후 재예약으로는 처리 가능하나, 별도 보강 추적 없음)

**필요한 작업**:
- [ ] **MakeupClass 엔티티** (`MakeupClass.java`)
  - [ ] 원래 결석한 출석 ID (원본 Attendance)
  - [ ] 보강 예약 ID (Reservation)
  - [ ] 보강 사유
  - [ ] 보강 상태 (대기, 완료, 취소)
  - [ ] 보강 만료일

- [ ] **MakeupClassService** (`MakeupClassService.java`)
  - [ ] 보강 신청 (결석 출석 -> 보강 예약 생성)
  - [ ] 보강 승인/거절
  - [ ] 보강 완료 처리
  - [ ] 보강 가능 횟수 조회 (학생별)

- [ ] **MakeupClassController** (`MakeupClassController.java`)
  - [ ] `POST /api/makeup-classes` - 보강 신청
  - [ ] `GET /api/makeup-classes/student/{id}` - 학생별 보강 내역
  - [ ] `PATCH /api/makeup-classes/{id}/approve` - 보강 승인
  - [ ] `DELETE /api/makeup-classes/{id}` - 보강 취소

- [ ] **프론트엔드 보강 관리 페이지** (`MakeupClasses.jsx`)
  - [ ] 보강 신청 폼
  - [ ] 보강 내역 조회
  - [ ] 보강 승인/거절 (관리자/선생님)

**예상 작업량**: 높음 (새로운 엔티티, 서비스, 컨트롤러, 프론트엔드 모두 필요)

**체크리스트 항목**:
- 체크리스트 8번: "보강 수업 예약 방식 => 어떻게 할지 정한 후, 추후 견적 추가"

**비용**: 추후 견적 추가 예정 (약 30만원 추정)

---

### 🟡 **4. 결석 시 횟수 자동 차감 규칙** ⚠️ (추가 옵션 +20만원)

**현황**: 미구현 (현재는 출석 체크 시에만 횟수 차감)

**필요한 작업**:
- [ ] **EnrollmentService 수정**
  - [ ] 결석 처리 시 자동 횟수 차감 옵션 추가
  - [ ] 관리자 수동 차감/복구 기능

- [ ] **Attendance 서비스 수정**
  - [ ] 결석(ABSENT) 상태 저장 시 수강권 횟수 차감 로직 추가
  - [ ] 사유결석(EXCUSED)은 차감 안 함 옵션

- [ ] **설정 관리** (선택사항)
  - [ ] 학원 정책 설정 페이지 (결석 차감 여부 설정)
  - [ ] Settings 엔티티 생성 (전역 설정 관리)

**예상 작업량**: 낮음~중간

**체크리스트 항목**:
- 체크리스트 1번: "결석/보강/연기 시 남은 횟수 처리 규칙 (자동 차감 / 수동 조절 중 선택) => 요구사항에 없는데 추가 하실지? 추가한다면 + 200,000 원"
- 체크리스트 8번: "결석 시 횟수 차감 여부"

**비용**: **+200,000원** (추가 옵션)

---

### 🟡 **5. 조기 하원/중도 퇴실 처리 규칙** ⚠️ (추가 옵션 +20만원)

**현황**: 조기 하원 상태(EARLY_LEAVE)는 있으나, 횟수 차감 규칙 없음

**필요한 작업**:
- [ ] **Attendance 서비스 수정**
  - [ ] 조기 하원 시 횟수 차감 여부 설정
  - [ ] 수업 시간의 N% 이상 수강 시에만 차감 (예: 50% 이상)

- [ ] **설정 관리**
  - [ ] 조기 하원 기준 시간 설정 (예: 수업의 50% 이상 수강)
  - [ ] 차감 여부 정책 설정

**예상 작업량**: 낮음

**체크리스트 항목**:
- 체크리스트 4번: "중도 퇴실 / 조기 하원 발생 시 처리 규칙 => 요구사항에 없는데, 추가가 필요한지? 추가한다면 + 200,000원 출석만 하면 일단 1회차감임 퇴실 하원 발생이랑 상관없음."

**비용**: **+200,000원** (추가 옵션)
**참고**: 체크리스트에 따르면 "출석만 하면 일단 1회차감"이므로, 이 옵션은 추가하지 않을 가능성 높음

---

### 🟡 **6. 상담 이력 Excel 저장** ⚠️ (추가 옵션 +6만원)

**현황**: 상담 기록은 DB에 저장되나, Excel 파일로 내보내기 기능 없음

**필요한 작업**:
- [ ] **Excel 라이브러리 추가** (Apache POI)
  - [ ] `build.gradle`에 의존성 추가
  ```gradle
  implementation 'org.apache.poi:poi:5.2.3'
  implementation 'org.apache.poi:poi-ooxml:5.2.3'
  ```

- [ ] **ConsultationController에 Excel 내보내기 엔드포인트 추가**
  - [ ] `GET /api/consultations/export/excel?studentId={id}` - 학생별 상담 기록 Excel 다운로드
  - [ ] `GET /api/consultations/export/excel?startDate={date}&endDate={date}` - 기간별 Excel 다운로드

- [ ] **ExcelExportService** (새로 생성)
  - [ ] 상담 기록을 Excel 형식으로 변환
  - [ ] 컬럼: 날짜, 학생명, 상담 제목, 상담 내용, 상담자, 후속 조치

- [ ] **프론트엔드 다운로드 버튼**
  - [ ] Consultations.jsx에 "Excel 다운로드" 버튼 추가

**예상 작업량**: 낮음

**체크리스트 항목**:
- 체크리스트 5번: "상담 이력 저장(excel) => 추가 시 + 60,000 원"

**비용**: **+60,000원** (추가 옵션)

---

### 🟡 **7. 보호자 로그인 없이 링크 접근 제한** ⚠️ (추가 옵션 +10만원)

**현황**: 현재는 PARENT 역할로 로그인하면 접근 가능, 하지만 "로그인 없이 링크만으로 예약" 기능 없음

**필요한 작업**:
- [ ] **Reservation Token 기능**
  - [ ] 학생별 고유 예약 링크 생성 (UUID 기반)
  - [ ] 링크로 접근 시 임시 세션 부여 (해당 학생 예약만 가능)
  - [ ] 링크 만료 시간 설정 (예: 7일)

- [ ] **ReservationToken 엔티티** (새로 생성)
  - [ ] 학생 ID
  - [ ] 토큰 값 (UUID)
  - [ ] 만료일
  - [ ] 사용 가능 여부

- [ ] **익명 예약 페이지** (`/public/reservation/{token}`)
  - [ ] 로그인 없이 접근 가능
  - [ ] 해당 학생의 예약만 가능
  - [ ] 수강권 정보 조회

**예상 작업량**: 중간

**체크리스트 항목**:
- 체크리스트 6번: "보호자 로그인 방식: 계정 역할 분리, 로그인 없이 링크 접근 불가 => 필요한가? 역할 및 권한을 나눠야 하므로, 추가 시 + 100,000 원"

**비용**: **+100,000원** (추가 옵션)

---

### 🔵 **8. 네이버 예약 크롤링** (사용자가 직접 구현 예정)

**현황**: 미구현 (사용자가 직접 구현한다고 명시)

**필요한 작업**:
- [ ] **Selenium 또는 Jsoup 라이브러리** 사용
- [ ] 네이버 예약 페이지 로그인 자동화
- [ ] 예약 정보 크롤링 (학생명, 예약 시간, 수업 종류, 메모)
- [ ] 크롤링한 데이터를 Reservation 엔티티로 저장
- [ ] 매일 자동 실행 스케줄러 (예: 매일 오전 6시)

**예상 작업량**: 높음

**체크리스트 항목**:
- 체크리스트 2번: "네이버 예약 연동 관련"
- "네이버 예약은 내가할게 그거는 넘기고 다른거해" (사용자의 첫 번째 메시지)

**비용**: 사용자가 직접 구현 (무료)

---

### 🟢 **9. 프론트엔드 - 공지사항 조회 페이지** (선택사항)

**현황**: 백엔드 API는 완료, 프론트엔드 페이지 미구현

**필요한 작업**:
- [ ] **Notices.jsx** 페이지 생성
  - [ ] 공지사항 목록 조회 (페이징)
  - [ ] 상단 고정 공지 표시
  - [ ] 공지사항 상세 조회 (조회수 증가)
  - [ ] 검색 기능 (제목/내용)

- [ ] **관리자용 공지사항 작성/수정/삭제 폼**
  - [ ] 제목, 내용 입력
  - [ ] 상단 고정 체크박스
  - [ ] 활성화/비활성화 토글

**예상 작업량**: 낮음 (API가 이미 완성되어 있음)

**체크리스트 항목**:
- 체크리스트 5번: "공지사항이 필요함"

**비용**: 무료 (이미 기본 요구사항에 포함)

---

### 🟢 **10. 청구서 카톡/문자 발송** (선택사항)

**현황**: 미구현

**필요한 작업**:
- [ ] **Invoice 엔티티** (청구서)
  - [ ] 학생 ID
  - [ ] 청구 금액
  - [ ] 청구 날짜
  - [ ] 납부 마감일
  - [ ] 납부 상태 (미납, 완납)

- [ ] **InvoiceService**
  - [ ] 청구서 생성
  - [ ] 청구서 문자 발송 (MessageService 연동)
  - [ ] 카카오톡 알림톡 발송 (선택, 별도 API 필요)

- [ ] **결제 연동** (선택사항)
  - [ ] 나이스페이먼츠 API 연동
  - [ ] 결제 완료 시 청구서 상태 업데이트

**예상 작업량**: 중간~높음 (결제 연동 포함 시 높음)

**체크리스트 항목**:
- 체크리스트 5번: "청구서 카톡 발송, 문자는 바로 가능. 문자도 괜찮다함 (결제선생) 뭘로할지 정하고 정해지면 나이스페이먼츠"

**비용**: 추후 결정 (나이스페이먼츠 연동 시 별도 비용 발생 가능)

---

### 🟢 **11. 예약 페이지 UI 개선** (선택사항)

**현황**: 예약 기능은 구현되었으나, 사용자 친화적인 UI 시안 없음

**필요한 작업**:
- [ ] **Reservations.jsx 페이지 리디자인**
  - [ ] 캘린더 형식의 예약 UI (FullCalendar 라이브러리 사용)
  - [ ] 시간대별 수업 슬롯 표시
  - [ ] 예약 가능한 시간대 강조
  - [ ] 원클릭 예약 기능

- [ ] **반응형 디자인** (태블릿/모바일 최적화)

**예상 작업량**: 중간

**체크리스트 항목**:
- 체크리스트 6번: "기존 예약 UI 시안 보유 여부 => 없다면 임의 생성"

**비용**: 무료 (기본 요구사항에 포함 가능)

---

## 📊 우선순위 요약

### 🔴 필수 개발 항목 (총 3개)
1. **마이페이지 (학생/보호자용)** - 체크리스트 필수 항목
2. **파일 업로드 API** - 상담 녹음 파일 업로드
3. **보강 수업 관리 시스템** - 별도 견적 필요

### 🟡 추가 옵션 항목 (총 4개, 별도 비용 발생)
4. **결석 시 횟수 자동 차감** (+200,000원)
5. **조기 하원 처리 규칙** (+200,000원)
6. **상담 이력 Excel 저장** (+60,000원)
7. **로그인 없이 링크 접근** (+100,000원)

### 🔵 사용자 직접 구현 (1개)
8. **네이버 예약 크롤링** - 사용자가 직접 구현 예정

### 🟢 선택사항 (총 3개, 기본 요구사항에 포함 가능)
9. **공지사항 조회 페이지** - 프론트엔드만 추가
10. **청구서 발송** - 추후 결정
11. **예약 페이지 UI 개선** - 사용자 경험 개선

---

## 💰 추가 비용 예상

| 항목 | 예상 비용 | 필수 여부 | 비고 |
|------|----------|---------|------|
| 마이페이지 | 기본 포함 | 필수 | 프론트엔드 개발만 필요 |
| 파일 업로드 API | 기본 포함 | 필수 | S3 사용 시 별도 AWS 비용 |
| 보강 수업 관리 | 약 30만원 | 필수 | 추후 견적 협의 |
| 결석 횟수 차감 | +20만원 | 옵션 | 체크리스트 명시 |
| 조기 하원 규칙 | +20만원 | 옵션 | 체크리스트 명시 |
| Excel 저장 | +6만원 | 옵션 | 체크리스트 명시 |
| 링크 접근 제한 | +10만원 | 옵션 | 체크리스트 명시 |
| 청구서 발송 | 추후 결정 | 옵션 | 결제 연동 포함 여부에 따라 |
| **총 추가 비용** | **56만원 ~ 86만원** | - | 옵션 선택에 따라 |

**참고**: 기본 계약 금액은 526만원이며, 위 추가 옵션은 별도 비용입니다.

---

## 🎯 다음 단계 제안

### 1단계: 필수 개발 항목 완료
1. **마이페이지 개발** (학생/보호자용 대시보드)
2. **파일 업로드 API** (상담 녹음/첨부 파일)
3. **보강 수업 관리 시스템** (별도 견적 후)

### 2단계: 미팅에서 추가 옵션 협의
- 결석 시 횟수 자동 차감 (+20만원) - 필요 여부?
- 조기 하원 처리 규칙 (+20만원) - 필요 여부? (체크리스트: "출석만 하면 1회차감"이므로 불필요할 수 있음)
- 상담 이력 Excel 저장 (+6만원) - 필요 여부?
- 로그인 없이 링크 접근 (+10만원) - 필요 여부?

### 3단계: 선택사항 개발
- 공지사항 프론트엔드 페이지
- 청구서 발송 시스템 (결제 연동 포함 여부 결정)
- 예약 페이지 UI 개선

### 4단계: 테스트 및 배포
- AWS 서버 세팅 (호스팅 비용 무료 처리 확정)
- 1개월 무료 유지보수 시작
- 이후 월 5만원 유지보수 또는 단건 청구

---

## 📝 미팅 시 확인 필요 사항

### 1. 필수 개발 항목 일정
- 마이페이지 개발: 약 1주일 소요 예상
- 파일 업로드 API: 스토리지 방식 결정 필요 (로컬 vs AWS S3)
- 보강 수업 관리: 요구사항 상세 확인 후 견적

### 2. 추가 옵션 선택
- 결석 시 횟수 차감: 필요한가요? (+20만원)
- 조기 하원 규칙: 필요한가요? (+20만원) - 체크리스트에는 "불필요"로 보임
- Excel 저장: 필요한가요? (+6만원)
- 링크 접근: 필요한가요? (+10만원)

### 3. 파일 스토리지 방식 결정
- **옵션 1**: 로컬 스토리지 (서버 용량 제한, 무료)
- **옵션 2**: AWS S3 (무제한, 월 사용량에 따라 과금)
- **옵션 3**: Cloudinary (CDN, 무료 플랜 10GB)

### 4. 청구서/결제 시스템
- 청구서만 문자 발송? (간단)
- 나이스페이먼츠 결제 연동? (복잡, 별도 비용)

### 5. 예약 UI 시안
- 기존 시안이 있나요?
- 없다면 FullCalendar 기반 임의 생성 예정

### 6. 네이버 예약 크롤링
- 사용자가 직접 구현 예정 확인
- 필요 시 기술 자문 가능

---

## ✅ 결론

**현재 구현률**: 약 92%

**필수 개발 항목**: 3개 (마이페이지, 파일 업로드, 보강 관리)

**추가 옵션**: 4개 (결석 차감, 조기 하원, Excel, 링크 접근)

**선택사항**: 3개 (공지사항 UI, 청구서, 예약 UI)

**시스템은 이미 프로덕션 배포 가능한 상태이며, 위 항목들은 추가 기능 개선을 위한 옵션입니다.**

---

**다음 단계**: 미팅에서 위 항목들을 협의하여 개발 우선순위와 예산을 최종 결정해주세요.
